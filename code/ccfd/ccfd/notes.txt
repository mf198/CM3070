V 1. gan and wgan can use cuDF, the others algorithms can't
V 2. grid_search and random_search to fine tune hyperparameters (used optuna)
V 3. split the dataset so that the percentage of frauds is balanced (added stratified k-fold validation)
4. compare cost based methods, describe why they can be valuable for financial institutions (fine tuning the thresholds between fp and fn)
5. plots to show data
6. eliminate the slowest/worst performing algo/ovs methods
7. create a DNN (autoencoder / variable autoencoder)
8. compare results
9. propose architecture (using 2/3 methods togheter and classify a TP only when the majority agrees)

10. explain why you uses StandardScaler instead of PCA for amount (data range very wide respect to other features)
    check pca variance for each feature (maybe scaling is needed)
    since I'm also testing ML algos, scaling is probably the best choice

11. Add tensorboard monitoring to model optimization

12. Check why wgan is so slow even with gpu

python -m scripts.train_models --device gpu --model knn --ovs gan --output_folder ccfd/pretrained_models --metric prauc --trials 100 --jobs 4
python -m scripts.train_models --device gpu --model knn --ovs wgan --output_folder ccfd/pretrained_models --metric prauc --trials 100 --jobs 4
python -m scripts.train_models --device gpu --model knn --ovs adasyn --output_folder ccfd/pretrained_models --metric prauc --trials 100 --jobs 4
python -m scripts.train_models --device gpu --model knn --ovs svm-smote --output_folder ccfd/pretrained_models --metric prauc --trials 100 --jobs 4

smote       [I 2025-03-11 18:35:49,029], [I 2025-03-11 18:42:29,863]    0.6839662399660338.
gan         [I 2025-03-11 21:38:52,878], [I 2025-03-11 21:44:49,223]    0.8099033216349059.
wgan        [I 2025-03-11 21:44:53,986], [I 2025-03-11 21:50:50,307]    0.8095022826196352.
adasyn      [I 2025-03-11 21:50:55,134], [I 2025-03-11 21:57:21,038]    0.6462168065715039.
svm-smote   [I 2025-03-11 22:01:48,044], 

python -m scripts.train_models --device gpu --model knn --ovs gan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model knn --ovs wgan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model knn --ovs adasyn --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model knn --ovs smote --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model knn --ovs gan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model knn --ovs wgan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model knn --ovs adasyn --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model knn --ovs smote --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model knn --ovs gan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model knn --ovs wgan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model knn --ovs adasyn --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model knn --ovs smote --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 4 

python -m scripts.train_models --device gpu --model lr --ovs gan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model lr --ovs wgan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model lr --ovs adasyn --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model lr --ovs smote --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model lr --ovs gan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model lr --ovs wgan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model lr --ovs adasyn --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model lr --ovs smote --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model lr --ovs gan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model lr --ovs wgan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model lr --ovs adasyn --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model lr --ovs smote --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 4 

python -m scripts.train_models --device gpu --model rf --ovs gan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model rf --ovs wgan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model rf --ovs adasyn --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model rf --ovs smote --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model rf --ovs gan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model rf --ovs wgan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model rf --ovs adasyn --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model rf --ovs smote --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model rf --ovs gan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model rf --ovs wgan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model rf --ovs adasyn --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model rf --ovs smote --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 4 

python -m scripts.train_models --device gpu --model xgboost --ovs gan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model xgboost --ovs wgan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model xgboost --ovs adasyn --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model xgboost --ovs smote --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model xgboost --ovs gan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model xgboost --ovs wgan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model xgboost --ovs adasyn --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model xgboost --ovs smote --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model xgboost --ovs gan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model xgboost --ovs wgan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model xgboost --ovs adasyn --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 4 
python -m scripts.train_models --device gpu --model xgboost --ovs smote --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 4 



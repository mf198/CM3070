V 1. gan and wgan can use cuDF, the others algorithms can't
V 2. grid_search and random_search to fine tune hyperparameters (used optuna)
V 3. split the dataset so that the percentage of frauds is balanced (added stratified k-fold validation)
4. compare cost based methods, describe why they can be valuable for financial institutions (fine tuning the thresholds between fp and fn)
5. plots to show data
6. eliminate the slowest/worst performing algo/ovs methods
7. create a DNN (autoencoder / variable autoencoder)
8. compare results
9. propose architecture (using 2/3 methods togheter and classify a TP only when the majority agrees)

10. explain why you uses StandardScaler instead of PCA for amount (data range very wide respect to other features)
    check pca variance for each feature (maybe scaling is needed)
    since I'm also testing ML algos, scaling is probably the best choice

11. Add tensorboard monitoring to model optimization

12. Check why wgan is so slow even with gpu
13. Check if Tensorboard is affecting training performance / propose the monitoring as optional parameter

14. Evaluate the use of a recurrent autoencoder in case of dataset containing date and time values
15. Explain early stopping and pruning
16. Possible hyperparameters tuning for larger datasets

python -m scripts.train_models --device gpu --model knn --ovs gan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs gan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs gan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs gan --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs wgan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs wgan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs wgan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs wgan --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs smote --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs smote --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs smote --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs smote --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs adasyn --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs adasyn --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs adasyn --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs adasyn --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs svmsmote --output_folder ccfd/pretrained_models --metric prauc --trials 5 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs svmsmote --output_folder ccfd/pretrained_models --metric f1 --trials 5 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs svmsmote --output_folder ccfd/pretrained_models --metric precision --trials 5 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs svmsmote --output_folder ccfd/pretrained_models --metric recall --trials 5 --jobs 3


python -m scripts.train_models --device gpu --model rf --ovs gan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs gan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs gan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs gan --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs wgan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs wgan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs wgan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs wgan --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs smote --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs smote --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs smote --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs smote --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs adasyn --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs adasyn --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs adasyn --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs adasyn --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs svmsmote --output_folder ccfd/pretrained_models --metric prauc --trials 5 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs svmsmote --output_folder ccfd/pretrained_models --metric f1 --trials 5 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs svmsmote --output_folder ccfd/pretrained_models --metric precision --trials 5 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs svmsmote --output_folder ccfd/pretrained_models --metric recall --trials 5 --jobs 3

python -m scripts.train_models --device gpu --model xgboost --ovs gan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs gan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs gan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs gan --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs wgan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs wgan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs wgan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs wgan --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs smote --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs smote --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs smote --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs smote --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs adasyn --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs adasyn --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs adasyn --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs adasyn --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs svmsmote --output_folder ccfd/pretrained_models --metric prauc --trials 5 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs svmsmote --output_folder ccfd/pretrained_models --metric f1 --trials 5 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs svmsmote --output_folder ccfd/pretrained_models --metric precision --trials 5 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs svmsmote --output_folder ccfd/pretrained_models --metric recall --trials 5 --jobs 2

python -m scripts.train_models --device gpu --model lr --ovs gan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs gan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs gan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs gan --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs wgan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs wgan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs wgan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs wgan --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs smote --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs smote --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs smote --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs smote --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs adasyn --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs adasyn --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs adasyn --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs adasyn --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs svmsmote --output_folder ccfd/pretrained_models --metric prauc --trials 5 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs svmsmote --output_folder ccfd/pretrained_models --metric f1 --trials 5 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs svmsmote --output_folder ccfd/pretrained_models --metric precision --trials 5 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs svmsmote --output_folder ccfd/pretrained_models --metric recall --trials 5 --jobs 2

python -m scripts.train_models --device cpu --model sgd --ovs gan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs gan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs gan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs gan --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs wgan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs wgan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs wgan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs wgan --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs smote --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs smote --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs smote --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs smote --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs adasyn --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs adasyn --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs adasyn --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs adasyn --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs svmsmote --output_folder ccfd/pretrained_models --metric prauc --trials 5 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs svmsmote --output_folder ccfd/pretrained_models --metric f1 --trials 5 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs svmsmote --output_folder ccfd/pretrained_models --metric precision --trials 5 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs svmsmote --output_folder ccfd/pretrained_models --metric recall --trials 5 --jobs 2


python -m scripts.train_models --device gpu --model knn --ovs wgan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs wgan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs wgan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model knn --ovs wgan --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs wgan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs wgan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs wgan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model rf --ovs wgan --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 3
python -m scripts.train_models --device gpu --model xgboost --ovs wgan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs wgan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs wgan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model xgboost --ovs wgan --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs wgan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs wgan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs wgan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 2
python -m scripts.train_models --device gpu --model lr --ovs wgan --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs wgan --output_folder ccfd/pretrained_models --metric prauc --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs wgan --output_folder ccfd/pretrained_models --metric f1 --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs wgan --output_folder ccfd/pretrained_models --metric precision --trials 30 --jobs 2
python -m scripts.train_models --device cpu --model sgd --ovs wgan --output_folder ccfd/pretrained_models --metric recall --trials 30 --jobs 2

python -m scripts.optimize_autoencoder --device gpu --model ae --trials 30 --jobs 3
python -m scripts.optimize_autoencoder --device gpu --model vae --trials 30 --jobs 3


train: 227452, 394
test: 56863, 98